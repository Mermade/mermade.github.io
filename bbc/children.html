<!DOCTYPE html>
<html>
  <head>
    <meta charset='utf-8'>
    <meta http-equiv="X-UA-Compatible" content="chrome=1">
	
	<meta name="description" content="Open source software including BBC Nitro feed parser" />

    <link rel="stylesheet" type="text/css" href="/stylesheets/stylesheet.css" media="screen">
    <link rel="stylesheet" type="text/css" href="/stylesheets/github-dark.css" media="screen">
    <!-- <link rel="stylesheet" type="text/css" href="stylesheets/print.css" media="print"> -->
	<link rel="stylesheet" type="text/css" href="/stylesheets/datatables.css" media="screen">
	
		<script src="/javascripts/jQuery-min.js"></script>
		<script src="/javascripts/dataTables.js"></script>
		
    <title>Software by Mermade</title>
  </head>

  <body>

    <header>
      <div class="container">
        <h1>Mermade Software</h1>
        <h2>Itches elegantly scratched</h2>

        <section id="downloads">
          <a href="https://github.com/Mermade" class="btn btn-github"><span class="icon"></span>Follow us on GitHub</a>
		  <a id="aPassHash" href="/static/passwordHasher.html" class="btn btn-passwd"><span class="icon"></span>Generate secure passwords</a>
		  <a href="mailto:meic@gmx.com" class="btn btn-mail"><span class="icon"></span>Contact us</a>
		</section>
      </div>
    </header>

    <div class="container">
      <section id="main_content">
	  
	  <table id="tblMain" class="display nowrap">
	  <thead>
	  <tr><td>PID</td><td>Type</td><td>Title</td>
	  </thead>
	  <tbody>
	  </tbody>
	  </table>

      </section>
    </div>
		
	<script language="JavaScript" type='text/javascript'>
		function getParameterByName(name) {
			name = name.replace(/[\[]/, "\\[").replace(/[\]]/, "\\]");
			var regex = new RegExp("[\\?&]" + name + "=([^&#]*)"),
				results = regex.exec(location.search);
			return results === null ? "" : decodeURIComponent(results[1].replace(/\+/g, " "));
		}
		$(document).ready(function(){
			var parent = getParameterByName('pid');
			var table = $('#tblMain').DataTable({
				"ajax": {
					url: 'http://www.bbc.co.uk/programmes/'+parent+'/episodes/player.json',
					"dataSrc": function(json){
						var result = [];
						for (var i in json.episodes) {
							var p = json.episodes[i].programme;
							//alert(JSON.stringify(p));
							var pid = '<a href="http://bbc.co.uk/programmes/'+p.pid+'">'+p.pid+'</a>'; 
							var title;
							if (p.type == 'brand' || p.type == 'series') {
								title = '<a href="/bbc/children.html?pid='+p.pid+'">'+p.title+'</a>';
							}
							else {
								title = '<a href="/bbc/detail.html?pid='+p.pid+'">'+p.title+'</a>';
							}
							var row = [pid,p.type,title];
							result.push(row);
						}
						//alert(result);
						return result;
					}
				}
			});
			//table.on( 'xhr', function () {
			//	var json = table.ajax.json();
			//	return {};
			//});
		});
	</script>

    
  </body>
</html>
