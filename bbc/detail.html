<!DOCTYPE html>
<html>
  <head>
    <meta charset='utf-8'>
    <meta http-equiv="X-UA-Compatible" content="chrome=1">
	
	<meta name="description" content="Open source software including BBC Nitro feed parser" />

    <link rel="stylesheet" type="text/css" href="/stylesheets/stylesheet.css" media="screen">
    <link rel="stylesheet" type="text/css" href="/stylesheets/github-dark.css" media="screen">
    <!-- <link rel="stylesheet" type="text/css" href="stylesheets/print.css" media="print"> -->
	<link rel="stylesheet" type="text/css" href="/stylesheets/datatables.css" media="screen">
	
		<script src="/javascripts/jQuery-min.js"></script>
		<script src="/javascripts/dataTables.js"></script>
		
    <title>Software by Mermade</title>
  </head>

  <body>

    <header>
      <div class="container">
        <h1>Mermade Software</h1>
        <h2>Itches elegantly scratched</h2>

        <section id="downloads">
          <a href="https://github.com/Mermade" class="btn btn-github"><span class="icon"></span>Follow us on GitHub</a>
		  <a id="aPassHash" href="/static/passwordHasher.html" class="btn btn-passwd"><span class="icon"></span>Generate secure passwords</a>
		  <a href="mailto:meic@gmx.com" class="btn btn-mail"><span class="icon"></span>Contact us</a>
		</section>
      </div>
    </header>

    <div class="container">
      <section id="main_content">
	  
	  <div><a id="imagelink" href=""><img id="image" src="" alt="Image placeholder"/></a>
	  </div>
	  
	  <table id="tblMain" class="display">
	  <thead>
	  <tr><td>Field</td><td>Value</td>
	  </thead>
	  <tbody>
	  </tbody>
	  </table>

      </section>
    </div>
		
	<script language="JavaScript" type='text/javascript'>
		function getParameterByName(name) {
			name = name.replace(/[\[]/, "\\[").replace(/[\]]/, "\\]");
			var regex = new RegExp("[\\?&]" + name + "=([^&#]*)"),
				results = regex.exec(location.search);
			return results === null ? "" : decodeURIComponent(results[1].replace(/\+/g, " "));
		}
		$(document).ready(function(){
			var parent = getParameterByName('pid');
			var table = $('#tblMain').DataTable({
				"ajax": {
					url: 'http://www.bbc.co.uk/programmes/'+parent+'.json',
					"dataSrc": function(json){
						var p = json.programme;
						
						if (p.image.pid) {
							$('#image').attr('src',"http://ichef.bbci.co.uk/images/ic/640x360/"+p.image.pid+".jpg");
							$('#imagelink').attr('href','http://bbc.co.uk/programmes/'+parent);
						}
						
						var result = [];
						for (var i in p) {
							if (!(p[i] instanceof Object)) {
								result.push([i,p[i]]);
							}
						}
						for (var i in p.versions) {
							var v = p.versions[i];
							for (var j in v) {
								if (!(v[j] instanceof Object)) {
									result.push(['Version #'+i+' '+j,v[j]]);
								}
							}
						}
						return result;
					}
				}
				//,
				//"columns": [
				//	{ "data": "0"},
				//	{ "data": "1"}
				//]
			});
			table.on( 'xhr', function () {
				var json = table.ajax.json();
				//alert( ((json && json.category_slice) ? json.category_slice.programmes.length : 0)+' row(s) were loaded');
				return {};
			});
			$('#category').change(function(){
				table.ajax.url('http://www.bbc.co.uk/radio/programmes/genres/'+this.value+'/player.json').load();
			});
			//
			//table.ajax.reload(function(data){
			//	alert('Got some data');
			//});
			//alert('oh');
		});
	</script>

    
  </body>
</html>
